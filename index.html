<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>darmarket</title>

  <script src="https://cdn.jsdelivr.net/npm/react@18/umd/react.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>

  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Tajawal', sans-serif;
      direction: rtl;
    }
  </style>
</head>
<body class="bg-gray-100">
<div id="root"></div>

<script type="text/babel">
const { useState, useRef } = React;

const App = () => {
  const [page, setPage] = useState("list");
  const [properties, setProperties] = useState([]);

  const propertyRef = useRef({
    title: "",
    price: "",
    city: "",
    rooms: "",
    bathrooms: "",
    area: "",
    type: "بيع",
    description: "",
    images: []
  });

  const handleImages = (files) => {
    propertyRef.current.images = Array.from(files).map(file =>
      URL.createObjectURL(file)
    );
  };

  const addProperty = (e) => {
    e.preventDefault();

    const p = propertyRef.current;

    if (!p.title || !p.price || !p.city) {
      alert("العنوان، السعر، والمدينة إجبارية");
      return;
    }

    setProperties(prev => [
      ...prev,
      {
        id: Date.now(),
        ...p
      }
    ]);

    propertyRef.current = {
      title: "",
      price: "",
      city: "",
      rooms: "",
      bathrooms: "",
      area: "",
      type: "بيع",
      description: "",
      images: []
    };

    setPage("list");
  };

  const AddPage = () => (
    <form onSubmit={addProperty} className="p-4 space-y-3">
      <input className="input" placeholder="عنوان العقار"
        onInput={e => propertyRef.current.title = e.target.value} />

      <input className="input" type="number" placeholder="السعر بالدرهم"
        onInput={e => propertyRef.current.price = e.target.value} />

      <input className="input" placeholder="المدينة"
        onInput={e => propertyRef.current.city = e.target.value} />

      <div className="flex gap-2">
        <input className="input" type="number" placeholder="غرف"
          onInput={e => propertyRef.current.rooms = e.target.value} />
        <input className="input" type="number" placeholder="حمامات"
          onInput={e => propertyRef.current.bathrooms = e.target.value} />
      </div>

      <input className="input" type="number" placeholder="المساحة (م²)"
        onInput={e => propertyRef.current.area = e.target.value} />

      <select className="input"
        onChange={e => propertyRef.current.type = e.target.value}>
        <option value="بيع">بيع</option>
        <option value="كراء">كراء</option>
      </select>

      <textarea className="input" rows="3" placeholder="وصف العقار"
        onInput={e => propertyRef.current.description = e.target.value}></textarea>

      <input type="file" multiple accept="image/*"
        onChange={e => handleImages(e.target.files)}
        className="w-full" />

      <button className="btn-green">إضافة العقار</button>
    </form>
  );

  const ListPage = () => (
    <div className="p-4 space-y-4">
      {properties.map(p => (
        <div key={p.id} className="bg-white rounded shadow p-3">
          {p.images[0] && (
            <img src={p.images[0]} className="w-full h-40 object-cover rounded mb-2" />
          )}
          <div className="font-bold">{p.title}</div>
          <div className="text-blue-600">{p.price} درهم</div>
          <div className="text-sm text-gray-600">{p.city} – {p.type}</div>
        </div>
      ))}
    </div>
  );

  return (
    <div>
      <div className="bg-blue-600 text-white p-3 flex justify-between">
        <div>darmarket</div>
        <button onClick={() => setPage(page === "add" ? "list" : "add")}>
          {page === "add" ? "الرجوع" : "إضافة"}
        </button>
      </div>

      {page === "add" ? <AddPage /> : <ListPage />}
    </div>
  );
};

ReactDOM.render(<App />, document.getElementById("root"));
</script>

<style>
.input {
  width: 100%;
  padding: 12px;
  border: 1px solid #ddd;
  border-radius: 8px;
}
.btn-green {
  width: 100%;
  background: #16a34a;
  color: white;
  padding: 14px;
  border-radius: 10px;
  font-weight: bold;
}
</style>

</body>
</html>
